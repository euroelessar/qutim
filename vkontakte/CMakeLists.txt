CMAKE_MINIMUM_REQUIRED( VERSION 2.6 )
PROJECT( VKONTAKTE )
SET( QT_USE_QTNETWORK TRUE )
SET( QT_USE_QTSCRIPT TRUE )
SET (QT_USE_QTWEBKIT true)

qutim_add_plugin( vkontakte
	COMPILE_FLAGS "-DLIBVKONTAKTE_LIBRARY"
	DISPLAY_NAME "VKontakte"
	DESCRIPTION "Simple implementation of vkontakte"
	GROUP "Protocols"
)

FILE( GLOB PLUGINS RELATIVE "${CMAKE_CURRENT_SOURCE_DIR}/plugins" "${CMAKE_CURRENT_SOURCE_DIR}/plugins/*" )

FOREACH( PLUGIN ${PLUGINS} )
	IF( IS_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/plugins/${PLUGIN}" AND EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/plugins/${PLUGIN}/CMakeLists.txt" )
		STRING( TOUPPER VKONTAKTE_${PLUGIN} PLUGIN_NAME)
		OPTION( ${PLUGIN_NAME} "" ON )
		IF( ${PLUGIN_NAME} )
			MESSAGE( "+ vkontakte extension '${PLUGIN_NAME}' added to build" )
			ADD_SUBDIRECTORY( ${CMAKE_CURRENT_SOURCE_DIR}/plugins/${PLUGIN} ${CMAKE_CURRENT_BINARY_DIR}/plugins/${PLUGIN})
		ELSE( ${PLUGIN_NAME} )
			MESSAGE( "- vkontakte extension '${PLUGIN_NAME}' will be skipped" )
		ENDIF( ${PLUGIN_NAME} )
	ENDIF( IS_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/plugins/${PLUGIN}" AND EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/plugins/${PLUGIN}/CMakeLists.txt" )
ENDFOREACH( PLUGIN )
