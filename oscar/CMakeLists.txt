CMAKE_MINIMUM_REQUIRED( VERSION 2.6 )
PROJECT( Oscar )

SET( QT_USE_QTNETWORK TRUE )
SET( QT_USE_QTXML TRUE )
ADD_QUTIMPLUGIN( "oscar" "src" )
SET_TARGET_PROPERTIES(oscar PROPERTIES COMPILE_FLAGS "-DLIBOSCAR_LIBRARY")
IF( QT_QCONFIG MATCHES "openssl" )
	add_definitions(-DOSCAR_SSL_SUPPORT)
ENDIF( QT_QCONFIG MATCHES "openssl" )

FILE( GLOB PLUGINS RELATIVE "${CMAKE_CURRENT_SOURCE_DIR}/plugins" "${CMAKE_CURRENT_SOURCE_DIR}/plugins/*" )
LIST( REMOVE_ITEM PLUGINS .svn _svn )

FOREACH( PLUGIN ${PLUGINS} )
    STRING( TOUPPER ${PLUGIN} PLUGIN_NAME)
    OPTION( ${PLUGIN_NAME} "" ON )
    IF( NOT DEFINED "NO_${PLUGIN_NAME}" )
	MESSAGE( "+ oscar plugin '${PLUGIN_NAME}' added to build" )
	ADD_QUTIMPLUGIN( oscar${PLUGIN} "plugins/${PLUGIN}" )
	TARGET_LINK_LIBRARIES( oscar${PLUGIN} oscar )
    ELSE( NOT DEFINED "NO_${PLUGIN_NAME}" )
	MESSAGE( "- oscar plugin '${PLUGIN_NAME}' will be skipped" )
    ENDIF( NOT DEFINED "NO_${PLUGIN_NAME}" )
ENDFOREACH( PLUGIN )
